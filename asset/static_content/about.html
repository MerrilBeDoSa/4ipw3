<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Documentation du Projet MVC - À propos</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
        h1, h2, h3 { color: #1F8DD6; }
        h1 { border-bottom: 2px solid #1F8DD6; padding-bottom: 5px; }
        pre { background: #f4f4f4; padding: 10px; }
        ul { margin-left: 20px; }
        .section { margin-bottom: 30px; }
    </style>
</head>
<body>

<h1>Projet MVC</h1>

<p>
    Les fonctionnalités spécifiques demandées pour le groupe :
</p>
<ul>
    <li>Source des pages statiques : hardcodé (assoc array)</li>
    <li>Sauvegarde de l’identification via session (login)</li>
    <li>Menu issus d’un fichier CSV</li>
    <li>Affichage d’un contenu supplémentaire dans le menu : (la liste des dates)</li>
    <li>Affichage des articles sur la page d’accueil (articles de la catégorie « on n'est pas des pigeons » Max 10)</li>
    <li>Recherche d’articles par readtime (min / max)</li>
    <li>Sauvegarde du panier d’articles favoris via cookie</li>
    <li>Options de présentation : choix de thème (light or dark or grey)</li>
    <li>Options de présentation : choix du font (3 font colors)</li>
</ul>

<hr>

<!-- I. CONFIG -->
<div class="section">
    <h2>I. Répertoire /app/config</h2>

    <h3>1. config/app.php</h3>
    <ul>
        <li><strong>Ajout : </strong>Pas de modification au code du prof :</li>
        <li><strong>Ajout : </strong>Définition du répertoire racine <code>ROOT_DIR</code></li>
        <li><strong>Ajout : </strong>Constante <code>MEDIA_ARTICLE_PATH</code> pour les images d'articles</li>
        <li><strong>Ajout : </strong>Constante <code>AJAX_ENABLED</code>(valeur par défaut : true) - prévision pour activer les appels Ajax.</li>
        <li><strong>Ajout : </strong>Constante <code>DEFAULT_SEARCH_LIMIT</code> - fixée à 5 pour la recherche.</li>
    </ul>

    <h3>2. config/model.php</h3>
    <ul>
        <li><strong>Ajout : </strong>Encore une fois pas de modification au code du prof :</li>
        <li><strong>Ajout : </strong>Choix dynamique de la configuration locale ou en classe via <code>MACHINE</code></li>
        <li><strong>Ajout : </strong>Constante <code>DATABASE_TYPE</code> (MySql ou CSV).</li>
        <li><strong>Ajout : </strong>Encore une fois des paramètres de connexion MySQL (port, user, password) selon l’environnement (home/classe).</li>
        <li><strong>Ajout : </strong>Constante <code>DATABASE_DSN</code> construite dynamiquement</li>
    </ul>
</div>

<hr>

<!-- II. CONTROLLERS -->
<div class="section">
    <h2>II. Répertoire /app/controller</h2>

    <h3>1. controller/article.php</h3>
    <ul>
        <li><strong>Ajout :</strong>Fonction<code>main_article()</code>qui affiche un seul article complet.</li>
        <li><strong>Validation :</strong>Vérifie que le paramètre  <code>art_id</code> est bien en entier positif.</li>
        <li><strong>Traitement :</strong>Utilise la fonction <code>get_article_a()</code> pour récupérer les données de l'article depuis le modèle.</li>
        <li><strong>Affichage :</strong>Génère l’en-tête, le contenu de l’article (via <code>html_article_main()</code>) et le pied de page HTML.</li>
    </ul>

    <h3>2. controller/dates.php</h3>
    <ul>
        <li><strong>Ajout :</strong>Fonction<code>main_dates()</code> pour afficher la liste des dates distinctes des articles.</li>
        <li><strong>Dépendances :</strong>Utilise <code>get_all_dates_article()</code> du modèle pour extraire les dates depuis la base de données.</li>
        <li><strong>Affichage :</strong> Génère une page HTML avec l’en-tête, la liste des dates via <code>html_date_sidebar()</code> et le pied de page.</li>
    </ul>

    <h3>3. controller/home.php</h3>
    <ul>
        <li><strong>Ajout :</strong> Fonction <code>main_home()</code> pour afficher la page d’accueil du site.</li>
        <li><strong>Données :</strong> Récupère les 10 derniers articles de la catégorie <code>id = 146</code> ("On n’est pas des pigeons") grâce à <code>get_latest_articles_by_category()</code>.</li>
        <li><strong>Affichage :</strong> Utilise <code>html_all_articles_main()</code> pour afficher les articles, avec un en-tête (menu) et un pied de page.</li>
    </ul>

    <h3>4. controller/login.php</h3>
    <ul>
        <li><strong>Ajout :</strong> Fonction <code>main_login()</code> qui gère la connexion et déconnexion des utilisateurs.</li>
        <li><strong>Connexion :</strong> Récupération des identifiants via POST. Vérification avec la fonction <code>login_validate()</code> (modèle).</li>
        <li><strong>Déconnexion :</strong> Via l'URL <code>?action=logout</code>, la session est détruite et l'utilisateur est redirigé vers l’accueil.</li>
        <li><strong>Session :</strong> Utilisation de <code>$_SESSION</code> pour mémoriser les informations de connexion (nom et rôle).</li>
        <li><strong>Affichage :</strong> Statut de l’utilisateur, message flash, formulaire ou bouton de déconnexion selon l’état connecté ou non.</li>
    </ul>

    <h3>5. controller/presse.php</h3>
    <ul>
        <li><strong>Ajout :</strong> Fonction <code>main_press()</code> qui permet d’afficher les articles filtrés par date (via <code>?date=YYYY-MM-DD</code>).</li>
        <li><strong>Paramètre GET :</strong> Si une date est présente dans l’URL, les articles correspondants sont récupérés avec <code>get_articles_by_date()</code>.</li>
        <li><strong>Fallback :</strong> Si aucune date n’est passée, la liste des articles est vide (à adapter si besoin).</li>
        <li><strong>Affichage :</strong> Utilisation de <code>html_all_articles_main()</code> pour afficher les articles dans la vue.</li>
    </ul>

    <h3>6. controller/search.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_search()</code></li>
        <li><strong>Rôle :</strong> Affiche tous les articles accompagnés du formulaire de recherche :
            <ul>
                <li>Récupère tous les articles grâce à la fonction <code>get_article_a()</code>.</li>
                <li>Affiche le formulaire de recherche avec <code>html_search_form()</code>.</li>
                <li>Affiche tous les articles (non filtrés) via <code>html_all_articles_main()</code>.</li>
            </ul>
        </li>
        <li><strong>Lien :</strong> Accessible via <code>?page=search</code>.</li>
    </ul>

    //////////////////////////////////////////////

    <h3>7. panier.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_panier()</code></li>
        <li><strong>Rôle :</strong> Gère l’ajout et la suppression d’articles favoris dans le « panier » (stocké dans la session) et affiche la liste des favoris par le view <code>html_panier_main()</code>.</li>
    </ul>

    <h3>8. press.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_press()</code></li>
        <li><strong>Rôle :</strong> Pour récupérer une liste d’articles (limité à 20) et afficher le contenu par le view, c'est votre code, rien ne change : <code>html_all_articles_main()</code>.</li>
    </ul>

    <h3>9. search.php (search)</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_search()</code></li>
        <li><strong>Rôle :</strong> Gère la recherche d’articles par mot-clé, c'est votre code monsieur et je me suis basé sur ça pour ajouter la recherche par des dates (<code>search_date_min</code> et <code>search_date_max</code>).
            Il récupère les données par le model et appelle le view pour afficher le formulaire de recherche et les résultats.</li>
    </ul>

    <h3>10. sponsor.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_sponsor()</code></li>
        <li><strong>Rôle :</strong> Récupère le contenu du sponsor depuis le model (<code>get_sponsor_content()</code>) et affiche la bannière par le view <code>html_banner()</code>.</li>
    </ul>

    <h3>11. static.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_static()</code></li>
        <li><strong>Rôle :</strong> Rien à modifier, c'est votre code, j'écris juste pour me rappeler : elle permet d’afficher des pages statiques. Il lit le contenu d’un fichier HTML situé dans <code>/asset/static_content</code> (<code>get_static_content()</code>) et assemble la page avec l’en-tête et le pied de page.</li>
    </ul>

    <h3>12. time.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>main_time()</code></li>
        <li><strong>Rôle :</strong> Gère la recherche d’articles en fonction du temps de lecture souhaité :
            <ul>
                <li>Récupère la durée saisie par l’utilisateur.</li>
                <li>Utilise la fonction <code>estimate_time()</code> (dans le view) pour calculer le temps de lecture de chaque article.</li>
                <li>Filtre les articles et affiche le résultat via <code>html_time_search_form()</code> et <code>html_time_list()</code>.</li>
            </ul>
        </li>
    </ul>
</div>

//////////////////////////////////////////////

<hr>

<!-- III. MODELS -->
<div class="section">
    <h2>III. Répertoire /app/model</h2>

    <h3>1. model/article.php</h3>
    <ul>
        <li><strong>Fonctionnalités principales :</strong></li>
        <ul>
            <li><code>get_article_a($id)</code> : Récupère un article spécifique (par défaut l’article d’ID 1 pour la home).</li>
            <li><code>get_article_a_sql($id)</code> : Exécute la requête SQL pour obtenir un article via son ID.</li>
            <li><code>get_latest_articles_by_category($id, $limit)</code> : Récupère les derniers articles d’une catégorie (ex. cat. 146 = "On n’est pas des pigeons").</li>
            <li><code>get_all_dates_article()</code> : Récupère toutes les dates distinctes des articles (utilisé pour la sidebar).</li>
            <li><code>get_articles_by_date($date)</code> : Récupère tous les articles publiés à une date précise.</li>
            <li><code>get_pdo()</code> : Singleton pour établir une connexion PDO à la base de données.</li>
        </ul>
        <li><strong>Dépend de :</strong> la constante <code>DATABASE_TYPE</code> et des infos de connexion (DSN, username, password).</li>
    </ul>

    <h3>2. model/common.php</h3>
    <ul>
        <li><strong>Fonctions :</strong>
            <ul>
                <li><code>get_menucsv()</code> : Charge les éléments du menu depuis le fichier <code>menu.csv</code> situé dans <code>/asset/database</code>.</li>
                <li><code>get_last_dates()</code> : Génère un tableau contenant les <em>n</em> dernières dates (par défaut 7), à partir de la date du jour.</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Fournir des fonctions utilitaires réutilisables (menu dynamique, dates récentes).</li>
    </ul>

    <h3>3. model/login.php</h3>
    <ul>
        <li><strong>Fonction :</strong>
            <ul>
                <li><code>login_validate(\$input_login, \$input_password)</code> : Vérifie si le couple identifiant/mot de passe existe dans <code>login.csv</code> et retourne un tableau contenant : validité, nom et rôle.</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Authentifier les utilisateurs en lisant un fichier CSV local, sans base de données.</li>
    </ul>

    <h3>4. model/template.php</h3>
    <ul>
        <li><strong>Fonction :</strong>
            <ul>
                <li>Inclut <code>common.php</code> pour accéder à <code>get_menucsv()</code> sans redondance.</li>
                <li>Initialise le menu via <code>\$menu = get_menucsv()</code>.</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Centraliser l’accès au menu CSV dans les autres vues ou contrôleurs.</li>
    </ul>

    //////////////////////////////////////////////

    <h3>5. sponsor.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>get_sponsor_content()</code></li>
        <li><strong>Rôle :</strong> Récupère et décode un fichier JSON distant contenant les informations de la bannière sponsor.</li>
    </ul>

    <h3>6. static.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>get_static_content()</code></li>
        <li><strong>Rôle :</strong> Lit les fichiers HTML (about.html, cgv.html) dans le dossier <code>/asset/static_content</code> pour afficher des pages statiques.</li>
    </ul>
</div>
//////////////////////////////////////////////
<hr>

<!-- IV. VIEWS -->
<div class="section">
    <h2>IV. Répertoire /app/views</h2>

    <h3>1. view/article.php</h3>
    <ul>
        <li><strong>Fonctions :</strong>
            <ul>
                <li><code>html_article_main()</code> : Affiche le contenu complet d’un article, avec image, titre, date, hook et texte.</li>
                <li><code>html_article_preview()</code> : Génère un aperçu d’article (utilisé dans les listes), avec image, titre, date et hook.</li>
                <li><code>html_all_articles_main()</code> : Affiche un article en vedette suivi des autres articles en grille (par 2).</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Générer le HTML pour l’affichage des articles (complet ou aperçu), dans différentes pages.</li>
    </ul>

    <h3>2. view/dates.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>html_date_sidebar()</code></li>
        <li><strong>Rôle :</strong> Affiche une liste verticale des dates distinctes d’articles dans une <code>&lt;aside&gt;</code>, chaque date étant un lien vers la page "Presse" avec un filtre par date (<code>?page=press&date=YYYY-MM-DD</code>).</li>
    </ul>

    <h3>3. view/home.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>html_body()</code></li>
        <li><strong>Rôle :</strong> Génère une section HTML simple avec un titre et un paragraphe de bienvenue (“HOME — Ceci est notre site”).</li>
    </ul>

    <h3>4. view/login.php</h3>
    <ul>
        <li><strong>Fonctions :</strong>
            <ul>
                <li><code>html_logout_button()</code> : Génère un bouton de déconnexion.</li>
                <li><code>form_login()</code> : Génère le formulaire HTML pour la connexion (login/password).</li>
                <li><code>html_user_status()</code> : Affiche un message de bienvenue ou d’anonymat selon la session.</li>
                <li><code>html_link_home()</code> : Lien de retour vers la page d’accueil.</li>
                <li><code>html_message()</code> : Affiche un message d’erreur ou d’information.</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Gère l'affichage des éléments liés à la connexion utilisateur (formulaire, statut, messages).</li>
    </ul>

    <h3>5. view/template.php</h3>
    <ul>
        <li><strong>Fonctions :</strong>
            <ul>
                <li><code>html_head()</code> : Génère le header HTML complet, incluant le menu principal, le sous-menu et le statut utilisateur.</li>
                <li><code>html_foot()</code> : Génère le pied de page HTML avec le logo AWebWiz.</li>
                <li><code>validate_menu_array()</code> : Vérifie la validité du tableau de menu avant affichage.</li>
            </ul>
        </li>
        <li><strong>Rôle :</strong> Centralise l'affichage de l’en-tête, du menu de navigation, et du footer, en intégrant le statut de session utilisateur (connecté ou non).</li>
    </ul>
    //////////////////////////////////////////////////
    <h3>6. search.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>html_search_form()</code></li>
        <li><strong>Rôle :</strong> Affiche le formulaire de recherche permettant de filtrer les articles par mot-clé et par dates.</li>
    </ul>

    <h3>7. sponsor.php</h3>
    <ul>
        <li><strong>Fonction :</strong> <code>html_banner()</code></li>
        <li><strong>Rôle :</strong> Affiche la bannière du sponsor en utilisant les données récupérées (texte, images, lien, couleur).</li>
    </ul>

    <h3>8. time.php</h3>
    <ul>
        <li><strong>Fonctions :</strong>
            <ul>
                <li><code>html_time_search_form()</code> : Affiche le formulaire pour rechercher par temps de lecture.</li>
                <li><code>html_time_list()</code> : Affiche la liste des articles filtrés avec leur temps de lecture calculé via <code>estimate_time()</code>.</li>
            </ul>
        </li>
    </ul>
</div>
//////////////////////////////////////////////////
<hr>

<!-- V. FONCTIONNALITÉS SPÉCIFIQUES DU GROUPE -->
<div class="section">
    <h2>V. Fonctionnalités Spécifiques</h2>
    <ul>
        <li>
            <strong>Pages statiques :</strong>
            <ul>
                <li>Les pages statiques (À propos, CGV) sont situées dans le dossier <code>/asset/static_content</code>.</li>
                <li>La fonction <code>get_static_content()</code> du modèle <em>static.php</em> lit ces fichiers pour les afficher.</li>
            </ul>
        </li>
        <li>
            <strong>Identification (login) et session :</strong>
            <ul>
                <li>La page de connexion est gérée dans <code>/app/controllers/login.php</code> et affichée via <code>/app/views/login.php</code>.</li>
                <li>La fonction <code>validate_api()</code> (dans <code>/app/models/login.php</code>) demande à l’API pour authentifier l’utilisateur.</li>
                <li>Les informations de l’utilisateur (nom, rôle) sont sauvegardées en session.</li>
            </ul>
        </li>
        <li>
            <strong>Menu dynamique à partir d’un fichier CSV :</strong>
            <ul>
                <li>Le fichier <code>menu.csv</code> situé dans <code>/asset/database</code> définit le menu.</li>
                <li>La fonction <code>get_menu_csv()</code> (dans <code>/app/models/common.php</code>) lit ce fichier et le menu est affiché dans <code>html_head()</code>.</li>
            </ul>
        </li>
        <li>
            <strong>Contenu supplémentaire au menu :</strong>
            <ul>
                <li>Le temps de lecture estimé des articles est calculé (via <code>estimate_time()</code> dans <code>/app/views/time.php</code>) et affiché dans la fonctionnalité de recherche par temps (<code>/app/controllers/time.php</code>).</li>
            </ul>
        </li>
        <li>
            <strong>Présentation d’articles sur la page d’accueil :</strong>
            <ul>
                <li>La fonction <code>get_all_article_ac_sql()</code> dans <code>/app/models/article.php</code> récupère jusqu’à 10 articles de la catégorie « on n'est pas des pigeons ».</li>
                <li>L’affichage est réalisé via <code>html_home_main()</code> dans <code>/app/views/home.php</code>.</li>
            </ul>
        </li>
        <li>
            <strong>Recherche d’articles par dates :</strong>
            <ul>
                <li>Le contrôleur <code>search.php</code> gère la récupération des dates min et max ainsi que du mot-clé.</li>
                <li>La vue <code>html_search_form()</code> affiche le formulaire de recherche.</li>
            </ul>
        </li>
        <li>
            <strong>Panier d’articles favoris :</strong>
            <ul>
                <li>La fonctionnalité est gérée dans <code>/app/controllers/panier.php</code> et stockée en session.</li>
                <li>Les favoris sont affichés via <code>html_panier_main()</code> dans <code>/app/views/panier.php</code>.</li>
            </ul>
        </li>
        <li>
            <strong>Options de présentation :</strong>
            <ul>
                <li>La sélection de la police, de la couleur de fond et du style de bordure se fait via des listes déroulantes générées dans <code>/app/controllers/button.php</code>.</li>
                <li>Les choix sont enregistrés en session par <code>/app/controllers/font.php</code> et appliqués dans <code>html_head()</code> (vue commune).</li>
            </ul>
        </li>
    </ul>
</div>

<hr>

<!-- VI. CONCLUSION -->
<div class="section">
    <h2>VI. MERCI, C'ÉTAIT MERRIL ET NILTON À VOTRE SERVICE </h2>
</div>

</body>
</html>
